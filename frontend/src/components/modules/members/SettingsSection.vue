<template>
	<!-- å€å¡Šï¼šå€‹äººè¨­å®šï¼å§‹ -->
	<div class="selectContent" id="settings" style="display: none;">
		<!-- ğŸŒˆ å€‹äººåŒ–è¨­å®š -->
		<section class="mb-4">
			<h5>å€‹äººåŒ–è¨­å®š</h5>
			<div class="soild"></div>
			<!-- <div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="darkModeToggle">
									<label class="form-check-label" for="darkModeToggle">æ·±è‰²æ¨¡å¼</label>
								</div> -->
			<div class="inp_modle mt-2">
				<label class="form-label">ä¸»é¡Œé¢¨æ ¼</label>
				<select id="themeSelector">
					<option value="default" selected>ç¶“å…¸é‡‘è™¹</option>
					<option value="ocean">æµ·é’åµï¼ˆæ¸¬è©¦ä¸»é¡Œï¼‰</option>
					<option value="dark">å¢¨éŸ»é»‘ï¼ˆæ¸¬è©¦ä¸»é¡Œï¼‰</option>
				</select>
			</div>
		</section>

		<!-- å€‹äººè³‡æ–™ç®¡ç† -->
		<section id="infoSection" class="mb-4 personal-info-section">
			<h5>å€‹äººè³‡æ–™ç®¡ç†</h5>
			<div class="soild"></div>
			<div class="inp_modle">
				<label>æš±ç¨±</label>
				<input type="text" value="é•·å®‰ä¸å•" class="edit-input" style="display:none;">
				<p class="display-text">é•·å®‰ä¸å•</p>
			</div>
			<div class="inp_modle">
				<label class="form-label">æ€§åˆ¥</label>
				<select class="edit-input" style="display:none;">
					<option>ç”·æ€§</option>
					<option>å¥³æ€§</option>
					<option>å…¶ä»– / ä¸é€éœ²</option>
				</select>
				<p class="display-text">ç”·æ€§</p>
			</div>
			<div class="inp_modle">
				<label class="form-label">ç”Ÿæ—¥</label>
				<input type="date" value="2000-01-01" class="edit-input" style="display:none;">
				<p class="display-text">2000-01-01</p>
			</div>

			<button id="toggleEditBtn" data-edit-text="ä¿®æ”¹å€‹äººè³‡è¨Š"
				class="btn btn-sm btn-outline-primary mt-2">ä¿®æ”¹å€‹äººè³‡è¨Š</button>
		</section>

		<!-- ğŸ“± è¯ç¹«æ–¹å¼ -->
		<section id="contactSection" class="mb-4 personal-info-section">
			<h5 class="mb-3">è¯ç¹«æ–¹å¼</h5>
			<div class="soild"></div>

			<div class="inp_modle towline">
				<div class="label-badge">
					<label>é›»å­ä¿¡ç®±</label>
					<span class="badge bg-success">å·²é©—è­‰</span>
				</div>
				<div class="d-flex align-items-center w-100">
					<input type="email" value="user@example.com" class="edit-input" style="display:none;">
					<p class="display-text">user@example.com</p>
					<!-- <button
											class="display-text btn btn-sm btn-outline-secondary ms-2">å¯„é€é©—è­‰ä¿¡</button> -->
				</div>
			</div>

			<div class="inp_modle towline">
				<div class="label-badge">
					<label>æ‰‹æ©Ÿè™Ÿç¢¼</label>
					<span class="badge bg-warning text-dark">æœªé©—è­‰</span>
				</div>
				<div class="d-flex align-items-center w-100">
					<input type="text" value="0912345678" class="edit-input" style="display:none;">
					<p class="display-text">0912345678</p>
					<button class="display-text btn btn-sm btn-outline-secondary ms-2">å¯„é€é©—è­‰ä¿¡</button>
				</div>
			</div>

			<button id="toggleContactEditBtn" data-edit-text="ä¿®æ”¹è¯ç¹«æ–¹å¼"
				class="btn btn-sm btn-outline-primary mt-2">ä¿®æ”¹è¯ç¹«æ–¹å¼</button>
		</section>

		<!-- ğŸ” éš±ç§èˆ‡å®‰å…¨æ€§ -->
		<section class="mb-4">
			<h5>éš±ç§èˆ‡å®‰å…¨æ€§</h5>
			<div class="soild"></div>

			<div id="accountSection" class="inp_modle towline personal-info-section">
				<label class="form-label">å¸³è™Ÿ</label>
				<div class="d-flex align-items-center w-100">
					<input type="email" value="myusername" class="edit-input" style="display:none;">
					<p class="display-text">myusername</p>
					<button id="toggleAccountEditBtn" class="btn btn-sm btn-outline-primary ms-2"
						data-edit-text="ä¿®æ”¹å¸³è™Ÿ">ä¿®æ”¹å¸³è™Ÿ</button>
				</div>
			</div>

			<div id="passwordSection" class="inp_modle towline personal-info-section">
				<label class="form-label">å¯†ç¢¼</label>
				<div class="d-flex align-items-center w-100">
					<input type="email" value="a***************a" class="edit-input" style="display:none;">
					<p class="display-text">a***************a</p>
					<button id="togglePasswordEditBtn" class="btn btn-sm btn-outline-primary ms-2"
						data-edit-text="ä¿®æ”¹å¯†ç¢¼">ä¿®æ”¹å¯†ç¢¼</button>
				</div>
			</div>

			<div class="d-flex justify-content-end mt-5">
				<button class="btn btn-outline-dark">å¸³è™Ÿç™»å‡º</button>
				<button class="btn btn-danger">åˆªé™¤å¸³è™Ÿ</button>è¦æœ‰æµ®çª—è¼¸å…¥DELETEæ‰èƒ½åˆªé™¤
			</div>
		</section>
	</div>
</template>

<script>
export default {
  name: "SettingsSection",
  mounted() {
    // åˆå§‹åŒ–ç·¨è¼¯æ§åˆ¶å€å¡Š
    this.setupToggleEdit("infoSection", "toggleEditBtn", "overlay");
    this.setupToggleEdit("contactSection", "toggleContactEditBtn", "overlay");
    this.setupToggleEdit("accountSection", "toggleAccountEditBtn", "overlay");
    this.setupToggleEdit("passwordSection", "togglePasswordEditBtn", "overlay");

    // åˆå§‹åŒ–ä¸»é¡Œè¨­å®š
    this.setupThemeSelector();
  },
  methods: {
    setupToggleEdit(sectionId, toggleBtnId, overlayId = null) {
      const section = document.getElementById(sectionId);
      const toggleBtn = document.getElementById(toggleBtnId);
      const overlay = overlayId ? document.getElementById(overlayId) : null;

      const inputs = section.querySelectorAll(".edit-input");
      const texts = section.querySelectorAll(".display-text");

      let isEditing = false;

      toggleBtn.addEventListener("click", () => {
        isEditing = !isEditing;

        inputs.forEach((input) => {
          input.style.display = isEditing ? "block" : "none";
          if (!isEditing) {
            const p = input.nextElementSibling;
            if (p) {
              if (input.tagName === "SELECT") {
                p.textContent = input.options[input.selectedIndex].text;
              } else {
                p.textContent = input.value;
              }
            }
          }
        });

        texts.forEach((p) => {
          p.style.display = isEditing ? "none" : "block";
        });

        toggleBtn.textContent = isEditing
          ? "å®Œæˆä¿®æ”¹"
          : toggleBtn.getAttribute("data-edit-text");
        toggleBtn.classList.toggle("btn-outline-primary", !isEditing);
        toggleBtn.classList.toggle("btn-primary", isEditing);

        if (overlay) {
          overlay.style.display = isEditing ? "block" : "none";
        }

        section.classList.toggle("editing", isEditing);
      });
    },

    setupThemeSelector() {
      const themeSelector = document.getElementById("themeSelector");

      // å¥—ç”¨å·²å„²å­˜çš„ä¸»é¡Œ
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme) {
        document.documentElement.setAttribute("data-theme", savedTheme);
        themeSelector.value = savedTheme;
      }

      // ä½¿ç”¨è€…åˆ‡æ›ä¸»é¡Œæ™‚å„²å­˜
      themeSelector.addEventListener("change", function () {
        const selected = this.value;

        if (selected === "default") {
          document.documentElement.removeAttribute("data-theme");
          localStorage.removeItem("theme");
        } else {
          document.documentElement.setAttribute("data-theme", selected);
          localStorage.setItem("theme", selected);
        }
      });
    },
  },
};
</script>
